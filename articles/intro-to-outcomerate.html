<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="outcomerate">
<title>Intro to outcomerate • outcomerate</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intro to outcomerate">
<meta property="og:description" content="outcomerate">
<meta property="og:image" content="https://docs.ropensci.org/outcomerate/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">outcomerate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-outcomerate.html">Intro to outcomerate</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/outcomerate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Intro to outcomerate</h1>
                        <h4 data-toc-skip class="author">Rafael Pilliard Hellwig</h4>
            
            <h4 data-toc-skip class="date">2024-02-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/outcomerate/blob/HEAD/vignettes/intro-to-outcomerate.Rmd" class="external-link"><code>vignettes/intro-to-outcomerate.Rmd</code></a></small>
      <div class="d-none name"><code>intro-to-outcomerate.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates the basic applications of the <code>outcomerate</code> package in R. I will draw on the popular <code>tidyverse</code> family of packages for the analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/outcomerate">outcomerate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
<p>To keep things lighthearted, I will use a toy dataset named <code>middleearth</code>. The data consists of 1691 rows, each representing an attempt to interview a member of middle earth. Not all elements in the sample resulted in a completed interview, however. Some cases could not be located, others were located but no one was available, some individuals were found but refused to participate, etc. These particular ‘dispositions’ can be summarized from the <code>code</code> variable in the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">middleearth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tabulate frequency table of outcomes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">middleearth</span>, <span class="va">code</span>, <span class="va">outcome</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">code</th>
<th align="left">outcome</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NE</td>
<td align="left">Not eligible</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="left">I</td>
<td align="left">Complete interview</td>
<td align="right">760</td>
</tr>
<tr class="odd">
<td align="left">P</td>
<td align="left">Partial interview</td>
<td align="right">339</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="left">Refusal and break-off</td>
<td align="right">59</td>
</tr>
<tr class="odd">
<td align="left">NC</td>
<td align="left">Non-contact</td>
<td align="right">288</td>
</tr>
<tr class="even">
<td align="left">UO</td>
<td align="left">Unlocated</td>
<td align="right">173</td>
</tr>
<tr class="odd">
<td align="left">O</td>
<td align="left">Other</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>It is common for survey practitioners to report a number of outcome rates. These rates give an indication as to the quality of the field work. For example, you may want to know the response rate: the proportion of all cases from our intended sample that actually resulted in an interview.</p>
<p>How might we go about calculating this?</p>
<p>When we inspect our disposition codes, it become apparent that there could be several ways to do this. For example, you may start by using the total number of complete cases (760) and diving this by the number of observations in the data, 760 / 1691 = 0.45. But what about partially completed interviews? If you include those, you would get a rate of (760 + 339) / 1691 = 0.65.</p>
<p>It turns out that there are a lot of ways to calculate such outcome rates. Unless we specify exactly what we mean by “response rate”, it is easy for claims regarding survey quality to become opaque, lacking comparability with other surveys. For this reason, the American Association for Public Opinion Research (AAPOR) has published a <a href="https://www.aapor.org/Standards-Ethics/Standard-Definitions-(1).aspx" class="external-link">set of standardized definitions</a> for practitioners. The guide has no fewer than 6 different variants of the ‘response rate.’ In the our example, the rates we calculated would match to AAPOR’s “Response Rate 1” and “Response Rate 2”:</p>
<p><span class="math display">\[
\textrm{RR1} = \frac{\textrm{I}}{\textrm{(I + P) + R + O + NC + (UO + UH)}} 
= \frac{760}{(760 + 339) + 59 + 1 + 288 + (173 + 0)} 
= 0.47
\]</span></p>
<p><span class="math display">\[
\textrm{RR2} = \frac{\textrm{(I + P)}}{\textrm{(I + P) + R + O + NC + (UO + UH)}} 
= \frac{(760 + 339)}{(760 + 339) + 59 + 1 + 288 + (173 + 0)} 
= 0.68
\]</span></p>
<p>What’s more, the guide has multiple definitions for contact rates, refusal rates, and cooperation rates, and weighted rates. It can easily become tedious to look all these up and calculate them by hand. The <code>outcomerate</code> package makes it easier by giving all rates (and more) in one go:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disp_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="fl">760</span>, P <span class="op">=</span> <span class="fl">339</span>, R <span class="op">=</span> <span class="fl">59</span>, NC <span class="op">=</span> <span class="fl">288</span>, O <span class="op">=</span> <span class="fl">1</span>, UO <span class="op">=</span> <span class="fl">173</span>, NE <span class="op">=</span> <span class="fl">71</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eligibility_rate.html">eligibility_rate</a></span><span class="op">(</span><span class="va">disp_counts</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/outcomerate.html">outcomerate</a></span><span class="op">(</span><span class="va">disp_counts</span>, e <span class="op">=</span> <span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt;        RR1        RR2        RR3        RR4        RR5        RR6      COOP1 </span></span>
<span><span class="co">#&gt; 0.46913580 0.67839506 0.47149080 0.68180052 0.52522460 0.75950242 0.65573770 </span></span>
<span><span class="co">#&gt;      COOP2      COOP3      COOP4       REF1       REF2       REF3       CON1 </span></span>
<span><span class="co">#&gt; 0.94823123 0.65630397 0.94905009 0.03641975 0.03660258 0.04077402 0.71543210 </span></span>
<span><span class="co">#&gt;       CON2       CON3       LOC1       LOC2 </span></span>
<span><span class="co">#&gt; 0.71902347 0.80096752 0.89320988 0.89769367</span></span></code></pre></div>
<p>Each of these rates has a precise definition (see <code><a href="../reference/outcomerate.html">?outcomerate</a></code> for details). As we can see, <code>RR1</code> and <code>RR2</code> match our earlier calculations. In the example, I needed to specify the parameter <code>e</code>, the estimated proportion of unknown cases unknowns (<code>UO</code>) that were eligible. The <code><a href="../reference/eligibility_rate.html">eligibility_rate()</a></code> offers a default way to calculate this, but others may be appropriate.</p>
<p>If we had wanted just to return the two rates from above, we could specify this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/outcomerate.html">outcomerate</a></span><span class="op">(</span><span class="va">disp_counts</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RR1"</span>, <span class="st">"RR2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       RR1       RR2 </span></span>
<span><span class="co">#&gt; 0.4691358 0.6783951</span></span></code></pre></div>
<div class="section level2">
<h2 id="more-advanced-uses">More Advanced Uses<a class="anchor" aria-label="anchor" href="#more-advanced-uses"></a>
</h2>
<p>In certain situations, you may want to calculate outcome rates based on a vector of codes, rather than a table of frequency counts. It is just as easy to obtain rates this way using <code>outcomerate</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the head of the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">middleearth</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   code  outcome            researcher region    Q1       Q2   day race   svywt</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> UO    Unlocated          #23        Beleriand <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>     1 Elf       32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> I     Complete interview #23        Beleriand No        7     1 Hobbit    52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> I     Complete interview #23        Beleriand No        7     1 Hobbit    52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P     Partial interview  #13        Beleriand No        7     1 Hobbit    52</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> NE    Not eligible       #50        Beleriand <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>     1 Man       85</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> I     Complete interview #23        Beleriand No        7     1 Man       85</span></span>
<span></span>
<span><span class="co"># calculate rates using codes; should be same result as before</span></span>
<span><span class="fu"><a href="../reference/outcomerate.html">outcomerate</a></span><span class="op">(</span><span class="va">middleearth</span><span class="op">$</span><span class="va">code</span>, e <span class="op">=</span> <span class="va">e</span><span class="op">)</span></span>
<span><span class="co">#&gt;        RR1        RR2        RR3        RR4        RR5        RR6      COOP1 </span></span>
<span><span class="co">#&gt; 0.46913580 0.67839506 0.47149080 0.68180052 0.52522460 0.75950242 0.65573770 </span></span>
<span><span class="co">#&gt;      COOP2      COOP3      COOP4       REF1       REF2       REF3       CON1 </span></span>
<span><span class="co">#&gt; 0.94823123 0.65630397 0.94905009 0.03641975 0.03660258 0.04077402 0.71543210 </span></span>
<span><span class="co">#&gt;       CON2       CON3       LOC1       LOC2 </span></span>
<span><span class="co">#&gt; 0.71902347 0.80096752 0.89320988 0.89769367</span></span></code></pre></div>
<p>Why might we prefer this input format, when it is just as easy to specify the counts?</p>
<p>Well, if we want to calculate outcome rates by some other covariate, we typically need to go back to the original data. For example, here we use <code>dplyr</code> and <code>tidyr</code> to calculate outcome rates of interest by race:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a small wrapper function</span></span>
<span><span class="va">get_rates</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RR1"</span>, <span class="st">"RR2"</span>, <span class="st">"COOP1"</span>, <span class="st">"COOP2"</span>, <span class="st">"CON1"</span>, <span class="st">"REF1"</span>, <span class="st">"LOC1"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="../reference/outcomerate.html">outcomerate</a></span><span class="op">(</span><span class="va">x</span>, rate <span class="op">=</span> <span class="va">rlist</span>, e <span class="op">=</span> <span class="va">e</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calculate rates by group</span></span>
<span><span class="va">middleearth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">race</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n     <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            Nhat  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">svywt</span><span class="op">)</span>,</span>
<span>            rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">get_rates</span><span class="op">(</span><span class="va">code</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"Outcome Rates by Race"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Outcome Rates by Race</caption>
<thead><tr class="header">
<th align="left">race</th>
<th align="right">n</th>
<th align="right">Nhat</th>
<th align="right">RR1</th>
<th align="right">RR2</th>
<th align="right">COOP1</th>
<th align="right">COOP2</th>
<th align="right">CON1</th>
<th align="right">REF1</th>
<th align="right">LOC1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Dwarf</td>
<td align="right">376</td>
<td align="right">5640</td>
<td align="right">0.29</td>
<td align="right">0.35</td>
<td align="right">0.78</td>
<td align="right">0.95</td>
<td align="right">0.37</td>
<td align="right">0.02</td>
<td align="right">0.92</td>
</tr>
<tr class="even">
<td align="left">Elf</td>
<td align="right">251</td>
<td align="right">8032</td>
<td align="right">0.08</td>
<td align="right">0.33</td>
<td align="right">0.21</td>
<td align="right">0.87</td>
<td align="right">0.38</td>
<td align="right">0.05</td>
<td align="right">0.41</td>
</tr>
<tr class="odd">
<td align="left">Hobbit</td>
<td align="right">404</td>
<td align="right">21008</td>
<td align="right">0.41</td>
<td align="right">0.86</td>
<td align="right">0.45</td>
<td align="right">0.94</td>
<td align="right">0.91</td>
<td align="right">0.05</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">Man</td>
<td align="right">659</td>
<td align="right">56015</td>
<td align="right">0.76</td>
<td align="right">0.89</td>
<td align="right">0.82</td>
<td align="right">0.97</td>
<td align="right">0.92</td>
<td align="right">0.03</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">Wizard</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="weighted-outcome-rates">Weighted Outcome Rates<a class="anchor" aria-label="anchor" href="#weighted-outcome-rates"></a>
</h3>
<p>In certain situations, we also wish to produce <em>weighted</em> outcome rates, using the survey weights that are provided in the data. This is easy to do with one additional parameter:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate weighted rates by group</span></span>
<span><span class="va">middleearth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n     <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            Nhat  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">svywt</span><span class="op">)</span>,</span>
<span>            rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">get_rates</span><span class="op">(</span><span class="va">code</span>, weight <span class="op">=</span> <span class="va">svywt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"Weighted Outcome Rates by Region"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Weighted Outcome Rates by Region</caption>
<thead><tr class="header">
<th align="left">region</th>
<th align="right">n</th>
<th align="right">Nhat</th>
<th align="right">RR1w</th>
<th align="right">RR2w</th>
<th align="right">COOP1w</th>
<th align="right">COOP2w</th>
<th align="right">CON1w</th>
<th align="right">REF1w</th>
<th align="right">LOC1w</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Beleriand</td>
<td align="right">415</td>
<td align="right">21579</td>
<td align="right">0.51</td>
<td align="right">0.75</td>
<td align="right">0.62</td>
<td align="right">0.91</td>
<td align="right">0.83</td>
<td align="right">0.07</td>
<td align="right">0.93</td>
</tr>
<tr class="even">
<td align="left">Rhun</td>
<td align="right">195</td>
<td align="right">9637</td>
<td align="right">0.55</td>
<td align="right">0.72</td>
<td align="right">0.74</td>
<td align="right">0.96</td>
<td align="right">0.75</td>
<td align="right">0.03</td>
<td align="right">0.92</td>
</tr>
<tr class="odd">
<td align="left">Eriador</td>
<td align="right">564</td>
<td align="right">29794</td>
<td align="right">0.64</td>
<td align="right">0.83</td>
<td align="right">0.75</td>
<td align="right">0.98</td>
<td align="right">0.85</td>
<td align="right">0.02</td>
<td align="right">0.94</td>
</tr>
<tr class="even">
<td align="left">Rhovanion</td>
<td align="right">306</td>
<td align="right">17830</td>
<td align="right">0.61</td>
<td align="right">0.85</td>
<td align="right">0.69</td>
<td align="right">0.96</td>
<td align="right">0.89</td>
<td align="right">0.03</td>
<td align="right">0.96</td>
</tr>
<tr class="odd">
<td align="left">Harad</td>
<td align="right">211</td>
<td align="right">11858</td>
<td align="right">0.60</td>
<td align="right">0.79</td>
<td align="right">0.74</td>
<td align="right">0.96</td>
<td align="right">0.82</td>
<td align="right">0.03</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<p>Compare this to the equivalent unweighted estimates, and you see that the results are not the same.</p>
<table class="table">
<caption>Unweighted Outcome Rates by Region</caption>
<thead><tr class="header">
<th align="left">region</th>
<th align="right">n</th>
<th align="right">Nhat</th>
<th align="right">RR1</th>
<th align="right">RR2</th>
<th align="right">COOP1</th>
<th align="right">COOP2</th>
<th align="right">CON1</th>
<th align="right">REF1</th>
<th align="right">LOC1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Beleriand</td>
<td align="right">415</td>
<td align="right">21579</td>
<td align="right">0.39</td>
<td align="right">0.62</td>
<td align="right">0.56</td>
<td align="right">0.89</td>
<td align="right">0.70</td>
<td align="right">0.07</td>
<td align="right">0.87</td>
</tr>
<tr class="even">
<td align="left">Rhun</td>
<td align="right">195</td>
<td align="right">9637</td>
<td align="right">0.41</td>
<td align="right">0.55</td>
<td align="right">0.71</td>
<td align="right">0.96</td>
<td align="right">0.57</td>
<td align="right">0.02</td>
<td align="right">0.87</td>
</tr>
<tr class="odd">
<td align="left">Eriador</td>
<td align="right">564</td>
<td align="right">29794</td>
<td align="right">0.51</td>
<td align="right">0.70</td>
<td align="right">0.71</td>
<td align="right">0.97</td>
<td align="right">0.72</td>
<td align="right">0.02</td>
<td align="right">0.89</td>
</tr>
<tr class="even">
<td align="left">Rhovanion</td>
<td align="right">306</td>
<td align="right">17830</td>
<td align="right">0.53</td>
<td align="right">0.78</td>
<td align="right">0.65</td>
<td align="right">0.96</td>
<td align="right">0.81</td>
<td align="right">0.03</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td align="left">Harad</td>
<td align="right">211</td>
<td align="right">11858</td>
<td align="right">0.50</td>
<td align="right">0.70</td>
<td align="right">0.68</td>
<td align="right">0.95</td>
<td align="right">0.73</td>
<td align="right">0.03</td>
<td align="right">0.90</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="by-date">By Date<a class="anchor" aria-label="anchor" href="#by-date"></a>
</h3>
<p>Lastly, another useful application of grouped analysis is to calculate the rates by date. This allows you to monitor the quality day by day and notice if performance starts to change over time.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># day-by-day quality monitoring</span></span>
<span><span class="va">middleearth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">get_rates</span><span class="op">(</span><span class="va">code</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">rate</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">rate</span>, start <span class="op">=</span> <span class="op">-</span><span class="fl">9</span>, end <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">type</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Outcome Rates Over Time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="intro-to-outcomerate_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>In this example, we can see that the contact rate (<code>CON</code>) and response rate (<code>RR</code>) start to degrade in quality towards day 30. If fieldwork was still continuing, this could be something to look into and attempt to explain and/or redress.</p>
</div>
</div>
<div class="section level2">
<h2 id="variance-estimation">Variance Estimation<a class="anchor" aria-label="anchor" href="#variance-estimation"></a>
</h2>
<p>To estimate the errors from estimates generated by <code><a href="../reference/outcomerate.html">outcomerate()</a></code>, the simplest approach is to use the normal approximation. Since outcome rates are nothing more than proportions (or nearly so), their standard error is given by <span class="math inline">\(SE(p) = \sqrt{(p(1-p))/n}\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first, calculate the outcome rates</span></span>
<span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outcomerate.html">outcomerate</a></span><span class="op">(</span><span class="va">middleearth</span><span class="op">$</span><span class="va">code</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        RR1        RR2        RR5        RR6      COOP1      COOP2      COOP3 </span></span>
<span><span class="co">#&gt; 0.46913580 0.67839506 0.52522460 0.75950242 0.65573770 0.94823123 0.65630397 </span></span>
<span><span class="co">#&gt;      COOP4       REF1       REF3       CON1       CON3       LOC1 </span></span>
<span><span class="co">#&gt; 0.94905009 0.03641975 0.04077402 0.71543210 0.80096752 0.89320988</span></span>
<span></span>
<span><span class="co"># estimate standard errors using the Normal approximation for proportions </span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">middleearth</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>With the standard error in hand, we can then construct frequentist confidence intervals:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate 95% confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">res</span> <span class="op">-</span> <span class="op">(</span><span class="va">se</span> <span class="op">*</span> <span class="fl">1.96</span><span class="op">)</span>, <span class="va">res</span> <span class="op">+</span> <span class="op">(</span><span class="va">se</span> <span class="op">*</span> <span class="fl">1.96</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            RR1       RR2       RR5       RR6     COOP1     COOP2     COOP3</span></span>
<span><span class="co">#&gt; [1,] 0.4453496 0.6561319 0.5014233 0.7391318 0.6330916 0.9376710 0.6336667</span></span>
<span><span class="co">#&gt; [2,] 0.4929220 0.7006582 0.5490259 0.7798730 0.6783838 0.9587915 0.6789412</span></span>
<span><span class="co">#&gt;          COOP4       REF1       REF3      CON1      CON3      LOC1</span></span>
<span><span class="co">#&gt; [1,] 0.9385691 0.02749088 0.03134782 0.6939260 0.7819369 0.8784892</span></span>
<span><span class="co">#&gt; [2,] 0.9595310 0.04534863 0.05020021 0.7369382 0.8199982 0.9079305</span></span></code></pre></div>
<p>Weighted variance estimation in complex surveys require different procedures that go beyond the scope of this vignette. We recommend using <code>svycontrast()</code> from the <code>survey</code> package to obtain design-based errors that account for elements such as clustering and stratification. Bootstrapping primary sampling units (PSUs) may also be an appropriate method depending on the design at hand.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
